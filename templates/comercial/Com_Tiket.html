{% extends 'base/base_print.html' %}{% load inventarios_filters %}

{% block title %} Tikets en Compra {% endblock title %}</title>

{% block context %}

    {% if forms.error %}
    <div class="form_errors" role="alert">
        {{ form.error }}
    </div>
    {% endif %}
    {% for field in form %}
        {% for error in field.errors %}
            <strong>{{ field.label }}</strong>: {{ error }}<br>
        {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
        <strong>{{ error }}</strong>
    {% endfor %}
    <div class="print_content">
        <table class="print_item_cont" border="0">


				{% for movimiento in object.com_ningres.movinvent_set.all %}
					<tr>
						<input type="hidden" value='{{ movimiento.mvi_nummovi }}' />
						<td><input value="{{ movimiento.mvi_product.exs_product }}"/></td>
						<td><input value="{{ movimiento.mvi_product.exs_detalle }}"/></td>
						<td><input value='{{ movimiento.mvi_kntidad|default:0|stringformat:"0.2f" }}'/></td>
					</tr>
				{% endfor %}

                {% if object.movinvent_set.all %}
                    {% for talla, saldo_talla in object|por_tallas:'tex_actua' %}
                        {% for _ in saldo_talla|por_saldo %}
                            {% cycle "<tr>" "" %}
                                <td class="print_item">{% comment %}<br> {% endcomment %}
                                    &nbsp;&nbsp;{{ object.exs_abrevia }}<br>
                                    &nbsp;&nbsp;<span class="print_fsize2em">Talla.: &nbsp;{{ talla }}</span>
                                    &nbsp;&nbsp;Cód.aux: {{ object.exs_costact|default:''|stringformat:"0.0f" }}
                                    &nbsp;&nbsp; <svg class="barcode"
                                          jsbarcode-format="code128c"
                                          jsbarcode-ean128="true"
                                          jsbarcode-flat="false"
                                          jsbarcode-height="30"
                                          jsbarcode-fontsize="14"
                                          jsbarcode-value="{{ object.exs_product }}"
                                          jsbarcode-textmargin="0">
                                        </svg> &nbsp;
                                </td>
                            {% cycle "" "</tr>" %}
                        {% endfor %}
                    {% endfor %}
                {% else %}
                    {% comment %}
                      # TODO: Èsto está mal (?) no recuerdo qué se hizo aquí.
                    {% endcomment %}
                    {% for _ in object.exs_saldact|por_saldo %}
                        {{ saldo_talla }}
                        {% cycle "<tr>" "" %}
                            <td class="print_item"><br>
                                &nbsp;&nbsp;{{ object.exs_abrevia }}<br>
                                &nbsp;&nbsp;Talla.: - &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                &nbsp;&nbsp;Cód.aux: {{ object.exs_costact|default:''|stringformat:"0.0f" }}
                                &nbsp;&nbsp; <svg class="barcode"
                                      jsbarcode-format="code128c"
                                      jsbarcode-ean128="true"
                                      jsbarcode-flat="false"
                                      jsbarcode-height="40"
                                      jsbarcode-fontsize="14"
                                      jsbarcode-value="{{ object.exs_product }}"
                                      jsbarcode-textmargin="0">
                                    </svg> &nbsp;
                            </td>

                        {% cycle "" "</tr>" %}
                    {% endfor %}
                {% endif %}

        </table>
    </div>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jsbarcode@3.8.0/dist/barcodes/JsBarcode.code128.min.js"></script>

    <script type="text/javascript">
        JsBarcode(".barcode").init();
    </script>
{% endblock context %}

